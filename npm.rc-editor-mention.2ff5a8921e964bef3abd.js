(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{"8gro":function(t,e,n){"use strict";n.r(e);var o=n("v83y"),r=n("QbLZ"),i=n.n(r),a=n("iCc5"),s=n.n(a),c=n("FYw3"),l=n.n(c),p=n("mRg0"),u=n.n(p),f=n("q1tI"),g=n.n(f),d=n("17x9"),h=n.n(d),y=n("TSYQ"),m=n.n(y),v=n("WU7Z"),S=n("i8i4"),C=n.n(S),b=n("Iq8E"),w=n("MFj2"),x=n("9Do8"),E=n.n(x),D=function(t){function e(){return s()(this,e),l()(this,t.apply(this,arguments))}return u()(e,t),e.prototype.render=function(){var t=this.props;return g.a.createElement("div",t)},e}(f.Component),K=!!S.createPortal,O=function(t){function e(){return s()(this,e),l()(this,t.apply(this,arguments))}return u()(e,t),e.prototype.componentDidMount=function(){this.renderOrReady()},e.prototype.componentDidUpdate=function(){this.renderOrReady()},e.prototype.renderOrReady=function(){K?this.props.renderReady():this.renderComponent()},e.prototype.renderComponent=function(){var t=this.props,e=t.children,n=t.container,o=t.renderReady;Object(S.unstable_renderSubtreeIntoContainer)(this,e,n,function(){o&&o.call(this)})},e.prototype.render=function(){if(K){var t=this.props,e=t.children,n=t.container;return Object(S.createPortal)(e,n)}return null},e}(g.a.Component),T=O;function k(t,e){var n,o,r,i,a,s=e.getAnchorKey(),c=e.getAnchorOffset()-1,l=t.getCurrentContent().getBlockForKey(s);if(l){var p=l.getText();return n=c,o=String(p),r=Number(n)>>>0,i=o.slice(0,r+1).search(/\S+$/),(a=o.slice(r).search(/\s/))<0?{word:o.slice(i),begin:i,end:o.length}:{word:o.slice(i,a+r),begin:i,end:a+r}}return""}function R(t,e){var n=t.getBoundingClientRect();if(n.width||n.height){var o=e||t.parentElement;return{top:n.top-o.clientTop,left:n.left-o.clientLeft}}return n}function M(t){var e=Array.isArray(t)?t:[t],n=e.join("").replace(/(\$|\^)/g,"\\$1");return e.length>1&&(n="["+n+"]"),new RegExp("(\\s|^)("+n+")[^\\s]*","g")}function A(t){var e=M(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"@"),n=[];return t.getBlockMap().forEach(function(t){for(var o=t.getText(),r=void 0;null!==(r=e.exec(o));)n.push(r[0].trim())}),n}O.propTypes={children:h.a.any,renderReady:h.a.func,container:h.a.any};var j=function(t){return!1!==t},F=function(t){function e(){s()(this,e);var n=l()(this,t.call(this));return n.onEditorStateChange=function(t){var e=n.props.store.getOffset();if(0===e.size)return n.closeDropDown(),t;var o=t.getSelection();if(!n.props.callbacks.getEditorState().getSelection().getHasFocus()&&o.getHasFocus())return t;var r=k(t,o).word;if(!r)return n.closeDropDown(),t;var i=e.map(function(e){var n=e.offsetKey,i=Object(b.decode)(n),a=i.blockKey,s=i.decoratorKey,c=i.leafKey;if(a!==o.anchorKey)return!1;var l=t.getBlockTree(a).getIn([s,"leaves",c]);if(!l)return!1;var p=l.get("start"),u=l.get("end");return!!r&&(p===u-1?o.anchorOffset>=p+1&&o.anchorOffset<=u&&n:o.anchorOffset>p+1&&o.anchorOffset<=u&&n)}),a=i.some(j);n.activeOffsetKey=i.find(j)||n.activeOffsetKey;var s=n.props.store.getTrigger(n.activeOffsetKey);if(!a||!o.getHasFocus())return n.closeDropDown(),t;var c=r.substring(s.length,r.length);return n.lastSearchValue===c&&n.lastTrigger===s||(n.lastSearchValue=c,n.lastTrigger=s,n.props.onSearchChange(c,s)),n.state.active||s&&-1===r.indexOf(s)||n.openDropDown(),t},n.onUpArrow=function(t){if(t.preventDefault(),n.props.suggestions.length>0){var e=n.state.focusedIndex-1;n.setState({focusedIndex:Math.max(e,0)})}},n.onBlur=function(t){t.preventDefault(),n.closeDropDown()},n.onDownArrow=function(t){t.preventDefault();var e=n.state.focusedIndex+1;n.setState({focusedIndex:e>=n.props.suggestions.length?0:e})},n.getContainer=function(){var t=document.createElement("div"),e=void 0;return n.props.getSuggestionContainer?(e=n.props.getSuggestionContainer(),t.style.position="relative"):e=document.body,e.appendChild(t),t},n.handleKeyBinding=function(t){return"split-block"===t},n.handleReturn=function(t){t.preventDefault();var e=n.props.suggestions[n.state.focusedIndex];return!!e&&(g.a.isValidElement(e)?n.onMentionSelect(e.props.value,e.props.data):n.onMentionSelect(e),n.lastSearchValue=null,n.lastTrigger=null,!0)},n.renderReady=function(){var t=n.dropdownContainer;if(t){var e=n.state.active,o=n.activeOffsetKey,r=n.props.store.getOffset().get(o);if(e&&r){var i=n.props.placement,a=n.getPositionStyle(!0,r.position()),s=parseFloat(a.top)-window.scrollY-t.offsetHeight<0,c=(window.innerHeight||document.documentElement.clientHeight)-(parseFloat(a.top)-window.scrollY)-t.offsetHeight<0;"top"!==i||s||(a.top=(parseFloat(a.top)-t.offsetHeight||0)+"px"),"bottom"===i&&c&&!s&&(a.top=(parseFloat(a.top)-t.offsetHeight||0)+"px"),Object.keys(a).forEach(function(e){t.style[e]=a[e]})}n.focusItem&&E()(C.a.findDOMNode(n.focusItem),t,{onlyScrollIfNeeded:!0})}},n.getNavigations=function(){var t=n.props,e=t.prefixCls,o=t.suggestions,r=n.state.focusedIndex;return o.length?g.a.Children.map(o,function(t,o){var i=o===r,a=i?function(t){n.focusItem=t}:null,s=m()(e+"-dropdown-item",{focus:i});return g.a.isValidElement(t)?g.a.cloneElement(t,{className:s,onMouseDown:function(){return n.onDropdownMentionSelect(t.props.value,t.props.data)},ref:a}):g.a.createElement(D,{ref:a,className:s,onMouseDown:function(){return n.onDropdownMentionSelect(t)}},t)},n):g.a.createElement("div",{className:e+"-dropdown-notfound "+e+"-dropdown-item"},n.props.notFoundContent)},n.state={isActive:!1,focusedIndex:0,container:!1},n}return u()(e,t),e.prototype.componentDidMount=function(){this.props.callbacks.onChange=this.onEditorStateChange},e.prototype.componentWillReceiveProps=function(t){t.suggestions.length!==this.props.suggestions.length&&this.setState({focusedIndex:0})},e.prototype.onDropdownMentionSelect=function(t,e){var n=this;setTimeout(function(){n.onMentionSelect(t,e)},100)},e.prototype.onMentionSelect=function(t,e){var n=this.props.callbacks.getEditorState(),r=this.props,i=r.store,a=r.onSelect,s=i.getTrigger(this.activeOffsetKey);if((a&&a(t,e||t),this.props.noRedup)&&-1!==A(n.getCurrentContent(),s).indexOf(""+s+t))return console.warn("you have specified `noRedup` props but have duplicated mentions."),this.closeDropDown(),void this.props.callbacks.setEditorState(function(t){var e=t.getSelection(),n=k(t,e),r=n.begin,i=n.end,a=o.Modifier.replaceText(t.getCurrentContent(),e.merge({anchorOffset:r,focusOffset:i}),"",null),s=o.Modifier.insertText(a,a.getSelectionAfter()," "),c=o.EditorState.push(t,s,"insert-mention");return o.EditorState.forceSelection(c,s.getSelectionAfter())}(n));this.props.callbacks.setEditorState(function(t,e,n,r){var i="immutable"===r?"IMMUTABLE":"MUTABLE",a=t.getSelection(),s=t.getCurrentContent();s.createEntity("mention",i,n||e);var c=k(t,a),l=c.begin,p=c.end,u=o.Modifier.replaceText(s,a.merge({anchorOffset:l,focusOffset:p}),e,null,s.getLastCreatedEntityKey()),f=o.Modifier.insertText(u,u.getSelectionAfter()," "),g=o.EditorState.push(t,f,"insert-mention");return o.EditorState.forceSelection(g,f.getSelectionAfter())}(n,""+s+t,e,this.props.mode),!0),this.closeDropDown()},e.prototype.getPositionStyle=function(t,e){if(this.props.getSuggestionStyle)return this.props.getSuggestionStyle(t,e);var n=R(this.props.getSuggestionContainer?this.state.container:document.body);return e?i()({position:"absolute",left:e.left-n.left+"px",top:e.top-n.top+"px"},this.props.style):{}},e.prototype.openDropDown=function(){this.props.callbacks.onUpArrow=this.onUpArrow,this.props.callbacks.handleReturn=this.handleReturn,this.props.callbacks.handleKeyBinding=this.handleKeyBinding,this.props.callbacks.onDownArrow=this.onDownArrow,this.props.callbacks.onBlur=this.onBlur,this.setState({active:!0,container:this.state.container||this.getContainer()})},e.prototype.closeDropDown=function(){this.props.callbacks.onUpArrow=null,this.props.callbacks.handleReturn=null,this.props.callbacks.handleKeyBinding=null,this.props.callbacks.onDownArrow=null,this.props.callbacks.onBlur=null,this.setState({active:!1})},e.prototype.render=function(){var t,e=this,n=this.props,o=n.prefixCls,r=n.className,a=n.placement,s=this.state,c=s.container,l=s.active,p=m()(i()(((t={})[o+"-dropdown"]=!0,t[o+"-dropdown-placement-"+a]=!0,t),r)),u="top"===a?"slide-down":"slide-up",f=this.getNavigations();return c?g.a.createElement(T,{renderReady:this.renderReady,container:c},g.a.createElement(w.default,{transitionName:u},l?g.a.createElement("div",{className:p,ref:function(t){e.dropdownContainer=t}},f):null)):null},e}(g.a.Component),B=F;F.propTypes={callbacks:h.a.object,suggestions:h.a.array,store:h.a.object,onSearchChange:h.a.func,prefixCls:h.a.string,mode:h.a.string,style:h.a.object,onSelect:h.a.func,getSuggestionContainer:h.a.func,notFoundContent:h.a.any,getSuggestionStyle:h.a.func,className:h.a.string,noRedup:h.a.bool,placement:h.a.string};var P=function(t){function e(){var n,o,r;s()(this,e);for(var i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];return n=o=l()(this,t.call.apply(t,[this].concat(a))),o.matchDecorates=function(t){var e=t.callbacks,n=t.suggestionRegex,r=t.decoratedText,i=n.exec(r);o.trigger=i[2],o.updatePortalPosition(o.props),e.setEditorState(e.getEditorState())},r=n,l()(o,r)}return u()(e,t),e.prototype.componentWillMount=function(){this.matchDecorates(this.props)},e.prototype.componentWillReceiveProps=function(t){t.decoratedText!==this.props.decoratedText&&this.matchDecorates(t),this.updatePortalPosition(t)},e.prototype.componentWillUnmount=function(){var t=this.props,e=t.offsetKey;t.mentionStore.inActiveSuggestion({offsetKey:e})},e.prototype.updatePortalPosition=function(t){var e=this,n=t.offsetKey;t.mentionStore.updateSuggestion({offsetKey:n,trigger:this.trigger,position:function(){var t=e.searchPortal,n=R(t);return{left:n.left,top:n.top,width:t.offsetWidth,height:t.offsetHeight}}})},e.prototype.render=function(){var t=this;return g.a.createElement("span",{ref:function(e){t.searchPortal=e},style:this.props.style},this.props.children)},e}(g.a.Component);P.propTypes={offsetKey:h.a.any,mentionStore:h.a.object,decoratedText:h.a.string,children:h.a.any,callbacks:h.a.any,suggestionRegex:h.a.any};var N=P,I=function(t){var e=t.children;return g.a.createElement("span",{style:{backgroundColor:"#e6f3ff"}},e)},V=n("JPcv"),H=Object(V.Map)(),U={offset:Object(V.Map)(),getOffset:function(){return H},getTrigger:function(t){var e=H.get(t);return e&&e.trigger},activeSuggestion:function(t){var e=t.offsetKey;H=H.set(e,{offsetKey:e})},inActiveSuggestion:function(t){var e=t.offsetKey;H=H.delete(e)},updateSuggestion:function(t){var e=t.offsetKey,n=t.position,o=t.trigger;H=H.set(e,{offsetKey:e,position:n,trigger:o})}};var W=function(){function t(e,n){s()(this,t),this.contentState=e,this.options=n}return t.prototype.generate=function(){var t=Object(o.convertToRaw)(this.contentState);return this.processContent(t)},t.prototype.processContent=function(t){var e=t.blocks,n=this.options.encode;return e.map(function(t){return n?t.text.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split(" ").join("&nbsp;").split("\n").join("<br > \n"):t.text}).join(n?"<br />\n":"\n")},t}();function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new W(t,e).generate()}function _(t,e,n){t.findEntityRanges(function(t){var e=t.getEntity();return e&&"mention"===n.getEntity(e).getType()},e)}function Y(){}var J=function(t){var e=t.entityKey,n=t.tag,o=t.callbacks.getEditorState().getCurrentContent().getEntity(e).getData();return g.a.createElement(n,i()({},t,{data:o}))};var $=function(t){function e(n){s()(this,e);var r=l()(this,t.call(this,n));return r.onEditorChange=function(t){var e=t.getSelection();r._decorator=t.getDecorator();var n=t.getCurrentContent();r.props.onChange?r.setState({selection:e},function(){r.props.onChange(n,L(n))}):r.setState({editorState:t,selection:e})},r.onFocus=function(t){r.props.onFocus&&r.props.onFocus(t)},r.onBlur=function(t){r.props.onBlur&&r.props.onBlur(t)},r.onKeyDown=function(t){r.props.onKeyDown&&r.props.onKeyDown(t)},r.reset=function(){r._editor.Reset()},r.mention=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={onChange:Y,onUpArrow:Y,onDownArrow:Y,getEditorState:Y,setEditorState:Y,handleReturn:Y,onBlur:Y},n={callbacks:e,mentionStore:U},o=M(t.prefix),r=t.tag||I,a=[{strategy:function(t,e){!function(t,e,n){for(var o=e.getText(),r=void 0,i=void 0,a=void 0;null!==(r=t.exec(o))&&(n(i=r.index,a=i+r[0].length),i!==a););}(o,t,e)},component:function(e){return g.a.createElement(N,i()({},e,n,{style:t.mentionStyle,suggestionRegex:M(t.prefix)}))}}];return"immutable"===t.mode&&a.unshift({strategy:_,component:function(t){return g.a.createElement(J,i()({tag:r},t,{callbacks:e}))}}),{name:"mention",Suggestions:function(t){return g.a.createElement(B,i()({},t,n,{store:U}))},decorators:a,onChange:function(t){return e.onChange?e.onChange(t):t},callbacks:e,export:L}}({prefix:r.getPrefix(n),tag:n.tag,mode:n.mode,mentionStyle:n.mentionStyle}),r.Suggestions=r.mention.Suggestions,r.plugins=[r.mention],r.state={suggestions:n.suggestions,value:n.value&&o.EditorState.createWithContent(n.value,new o.CompositeDecorator(r.mention.decorators)),selection:o.SelectionState.createEmpty()},"string"==typeof n.defaultValue&&console.warn("The property `defaultValue` now allow `EditorState` only, see http://react-component.github.io/editor-mention/examples/defaultValue.html "),void 0!==n.value&&(r.controlledMode=!0),r}return u()(e,t),e.prototype.componentWillReceiveProps=function(t){var e=t.suggestions,n=this.state.selection,r=t.value;r&&n&&(r=o.EditorState.acceptSelection(o.EditorState.createWithContent(r,this._decorator),n)),this.setState({suggestions:e,value:r})},e.prototype.getPrefix=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return Array.isArray(t.prefix)?t.prefix:[t.prefix]},e.prototype.render=function(){var t,e=this,n=this.props,r=n.prefixCls,a=n.style,s=n.tag,c=n.multiLines,l=n.editorKey,p=n.suggestionStyle,u=n.placeholder,f=n.defaultValue,d=n.className,h=n.notFoundContent,y=n.getSuggestionContainer,S=n.readOnly,C=n.disabled,b=n.placement,w=n.mode,x=this.state.suggestions,E=this.Suggestions,D=m()(d,((t={})[r+"-wrapper"]=!0,t.readonly=S,t.disabled=C,t.multilines=c,t)),K=this.controlledMode?{value:this.state.value}:{},O=f&&o.EditorState.createWithContent("string"==typeof f?o.ContentState.createFromText(f):f,this._decorator);return g.a.createElement("div",{className:D,style:a,ref:function(t){return e._wrapper=t}},g.a.createElement(v.a,i()({ref:function(t){return e._editor=t},prefixCls:r,style:a,multiLines:c,editorKey:l,plugins:this.plugins,defaultValue:O,placeholder:u,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onChange:this.onEditorChange},K,{readOnly:S||C}),g.a.createElement(E,{mode:s?"immutable":w,prefix:this.getPrefix(),prefixCls:r,style:p,placement:b,notFoundContent:h,suggestions:x,getSuggestionContainer:y?function(){return y(e._wrapper)}:null,onSearchChange:this.props.onSearchChange,onSelect:this.props.onSelect,noRedup:this.props.noRedup})))},e}(g.a.Component);$.propTypes={value:h.a.object,suggestions:h.a.array,prefix:h.a.oneOfType([h.a.string,h.a.arrayOf(h.a.string)]),prefixCls:h.a.string,tag:h.a.oneOfType([h.a.element,h.a.func]),style:h.a.object,className:h.a.string,onSearchChange:h.a.func,onChange:h.a.func,mode:h.a.string,multiLines:h.a.bool,suggestionStyle:h.a.object,placeholder:h.a.string,defaultValue:h.a.object,notFoundContent:h.a.any,position:h.a.string,onFocus:h.a.func,onBlur:h.a.func,onSelect:h.a.func,onKeyDown:h.a.func,getSuggestionContainer:h.a.func,noRedup:h.a.bool,mentionStyle:h.a.object,placement:h.a.string,editorKey:h.a.string},$.controlledMode=!1,$.defaultProps={prefixCls:"rc-editor-mention",prefix:"@",mode:"mutable",suggestions:[],multiLines:!1,className:"",suggestionStyle:{},notFoundContent:"无法找到",position:"absolute",placement:"bottom",mentionStyle:{}};var q=$;function Q(t){return o.ContentState.createFromText(t)}n.d(e,"toEditorState",function(){return Q}),n.d(e,"Nav",function(){return D}),n.d(e,"toString",function(){return L}),n.d(e,"getMentions",function(){return A}),q.Nav=D,q.toString=L,q.toEditorState=Q,q.getMentions=A;e.default=q}}]);